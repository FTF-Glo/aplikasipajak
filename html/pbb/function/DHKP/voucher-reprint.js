function HandlerFilterjenisChange(){var a=document.getElementById("jenis-laporan");var b=document.getElementById("input_harian");var c=document.getElementById("input_bulanan");var d=document.getElementById("btnUnduh");if(a){if(a.value=="1"){if(b)b.style.display="none";if(c)c.style.display="inline";if(d)d.style.display="none"}else{if(b)b.style.display="inline";if(d)d.style.display="inline";if(c)c.style.display="none"}}}function numbersonly(a,b,c){var d;var e;if(window.event)d=window.event.keyCode;else if(b)d=b.which;else return true;e=String.fromCharCode(d);if(d==null||d==0||d==8||d==9||d==13||d==27)return true;else if("0123456789".indexOf(e)>-1)return true;else if(c&&e=="."){a.form.elements[c].focus();return false}else return false}function saveItem(a){var b=document.getElementById("profit-"+a).value;var c=document.getElementById("ppid").value;var d="{'ppid' :'"+c+"','prodid' :'"+a+"','price':'"+b+"'}";var e=Base64.encode(d);Ext.Ajax.request({url:"svr/voucher/svc-voucher-save-item.php",success:saveItemSuccess,failure:saveItemFailure,params:{req:e}});showMask()}function saveItemFailure(a,b){alert("Inquiry Gagal Karena Koneksi: "+a.responseText);hideMask()}function saveItemSuccess(a,b){var c=Ext.decode(Base64.decode(a.responseText));if(c.success){document.getElementById("lbl-"+c.prodid).innerHTML=c.profit}else{alert("Error Update dari server: ")}hideMask()}function downloadFile(){ft=document.getElementById("filtertgl");if(ft.value!=""){urlparam=Base64.encode(ft.value);url="http://"+window.location.host+window.location.pathname.replace("main.php","")+"svr/voucher/svc-voucher-download-detail-daily.php?q="+urlparam;document.getElementById("download-file").src=url}}function sendReport(){var a=document.getElementById("jenis-laporan");var b=a.options[a.selectedIndex].value;var c=document.getElementById("filtertgl").value;var d=document.getElementById("filterbl").value;var e=document.getElementById("filterth").value;if(b!=""&&c!=""){if(b=="0"){var f="{'req':'getReport','dateTrs' : '"+c+"','report':'"+b+"'}"}else{var f="{'req':'getReport','monthTrs' : '"+d+"','yearTrs' : '"+e+"','report':'"+b+"'}"}f=Base64.encode(f);Ext.Ajax.request({url:"svr/voucher/svc-voucher-report.php",success:sendReportSuccess,failure:sendFindException,params:{req:f}});showMask()}else{alert("Pencetakan laporan tidak bisa dilakukan !")}}function print64(a){var b=document.jZebra;if(b!=null){console.log(a);if(a.substr(0,3)=="1~~"||a.substr(0,3)=="0~~"){b.appendRawOnpays(a);b.printOnpays()}else{b.append64(a);b.print()}monitorPrinting()}else{alert("Applet not loaded!")}}function printReport(a,b){for(var c=0;c<b;c++){print64(a)}}function monitorPrinting(){var a=document.jZebra;if(a!=null){while(!a.isDonePrinting()){}var b=a.getException();if(b!=null){alert("Pastikan Seting Nama Printer anda Betul!\r\nException occured: "+b.getLocalizedMessage())}}else{alert("Applet not loaded!")}}function sendReportSuccess(a){hideMask();if(a.responseText){var b=Ext.decode(Base64.decode(a.responseText));if(b.result){var c="<input name='btnSend' type='button' value='Cetak Ke Printer' onclick='printReport(\""+b.printcode+'",'+b.printcopy+");'><br>";document.getElementById("voucher-report-result").innerHTML=c+b.message}else{document.getElementById("voucher-report-result").innerHTML='<label style="font-weight:bold;color:red">'+b.message+"</label>"}}}function sendReprint(a){if(a!=""){var b="{'req':'getDataToPrint','refnum' : '"+a+"'}";b=Base64.encode(b);Ext.Ajax.request({url:"svr/voucher/svc-voucher-reprint.php",success:sendReprintSuccess,failure:sendFindException,params:{req:b}});showMask()}else{alert("Pencetakan tidak bisa dilakukan !")}}function sendReprintSuccess(a){hideMask();if(a.responseText){var b=Ext.decode(Base64.decode(a.responseText));if(b.result){print64(b.printStruk)}else{document.getElementById("elpost-reprint-main-result").innerHTML='<label style="font-weight:bold;color:red">'+b.message+"</label>"}}}function findVoucher(){var a=document.getElementById("filtermsisdn").value;var b=document.getElementById("filtertgl").value;var c=document.getElementById("filterprodid").value;if(a!=""&&b!=""){var d="{'req':'getList','msisdn' : '"+a+"','dateTrs' :'"+b+"','prodid':'"+c+"'}";d=Base64.encode(d);Ext.Ajax.request({url:"svr/voucher/svc-voucher-reprint.php",success:sendFindSuccess,failure:sendFindException,params:{req:d}});showMask()}else{alert("Pencarian tidak bisa dilakukan !, silahkan isi no hp, kode voucher, dan harga jual.")}}function sendFindException(a){hideMask()}function sendFindSuccess(a){hideMask();if(a.responseText){var b=Ext.decode(Base64.decode(a.responseText));if(b.result){document.getElementById("elpost-reprint-main-result").innerHTML=b.message}else{document.getElementById("elpost-reprint-main-result").innerHTML='<label style="font-weight:bold;color:red">Data Tidak ditemukan !</label>'}}}function showMask(){showDialog("Load",'<img src="image/large-loading.gif" width="32" height="32" style="margin-right:8px;" align="absmiddle"/>Tunggu',"prompt",false,true)}function hideMask(){hideDialog()}